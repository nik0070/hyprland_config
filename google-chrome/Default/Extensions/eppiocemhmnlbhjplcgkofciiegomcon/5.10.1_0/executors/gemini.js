(()=>{const r=(()=>{const r=sessionStorage.getItem("bis_data");return null!==r?JSON.parse(r):null})(),T=r?.config?`${r.id}_t`:null,l=r?.config?.aiMessagesConfig?.GEMINI||{},{PARSERS:H=[],CHATBOT_NAME:F="",QUERY_GET_CHAT_MODEL:y,QUERY_GET_SUBSCRIPTION:P,PAID_SUBSCRIPTION_VALUES:X}=l,I=function(){const r=document.querySelector(P)?.textContent;return X.some((T=>T===r?.toLowerCase()))},R=function(r,l,H,P){let X={chatbotName:F,chatModel:document.querySelector(y)?.textContent,subscription:I(),messages:[]},R={},_={};if(r?.length){let T=decodeURIComponent(r),H=T.split(P.GENERAL_DATA.SEPARATOR_PARAMETERS)?.[0];if(H){let r=H.replace(new RegExp(P.GENERAL_DATA.REPLACEMENT_PARAMETER,"g"),""),T=JSON.parse(JSON.parse(r)?.filter((r=>r)))?.filter((r=>r))?.[2]?.[0],F=self.location.href.match(new RegExp(P.GENERAL_DATA.REGEXP_SESSION_ID_FROM_URL))?.groups?.sessionId;X.sessionId=T.length?T.replace(new RegExp(P.GENERAL_DATA.REPLACEMENT_PREFIX_SESSION_ID),""):F,M(R,r,l,P.SENT_MESSAGE)}}t(_,H,P.RECEIVED_MESSAGE),R?.messageText&&X.messages.push(R),_?.messageText&&X.messages.push(_),X.messages.length&&setTimeout((()=>(r=>{try{let l={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"GEMINI_DATA",from:T,to:T.substring(0,T.length-2),content:r};window.postMessage(l)}catch(r){}})(X)),0)},_=function(r,T,l,H){try{R(r,l,T,H)}catch(r){}},t=function(r,T,l){if(!T?.length)return;let H="",F=T.replace(new RegExp(l.REGEXP_REMOVE_GARBAGE),"").split(new RegExp(l.REGEXP_SPLITER)).map((r=>r.trim())).filter((r=>r)),y=[0,0];for(let r of F){let T=F.indexOf(r);y[1]<r.length&&(y[1]=r.length,y[0]=T)}if(l.RED_FLAG_VALUES_FOR_MEDIA.some((r=>F[y[0]].includes(r))))return;let P=new RegExp(l.REGEXP_GET_MESSAGE_TEXT);H=F[y[0]].match(P)?.groups?.message,H&&D(r,H,l)},D=function(r,T,l){r.messageText=T,r.messageType=l.MESSAGE_TYPE,r.creationTime=null,U(r,l.MESSAGE_LENGTH||3e4)},M=function(r,T,l,H){try{V(r,T,l,H)}catch(r){}},V=function(r,T,l,H){let F=JSON.parse(JSON.parse(T)?.filter((r=>r)))?.filter((r=>r))?.[0]?.[0];F?.length?(r.messageText=F,r.messageType=H.MESSAGE_TYPE,r.creationTime=l,U(r,H.MESSAGE_LIMIT||1e4)):r=null},U=function(r,T){let l=r.messageText,H=l.split("");"\\"===H[H.length-1]&&(H[H.length-1]="",l=H.join("")),r.messageText=l.trim().slice(0,T),r.messageLength=l.length},Q={XMLHttpRequest:function(r){const T=XMLHttpRequest.prototype.open,l=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(r,l){return this._requestMethod=r,this._requestUrl=l,T.apply(this,arguments)},XMLHttpRequest.prototype.send=function(T){let H=this.onreadystatechange;const F=new Date;return this.onreadystatechange=function(){try{4===this.readyState&&function(r,T,l){return new RegExp(l.REGEXP_URL_CHECK).test(r)&&T===l.REQUEST_METHOD}(this._requestUrl,this._requestMethod,r)&&setTimeout(_.bind(this,T,this.responseText,F,r),0)}catch(r){if(H)return H.apply(this,arguments)}if(H)return H.apply(this,arguments)},l.apply(this,arguments)}}};!function(){for(let r of H)r.USE&&Q[r.TYPE](r)}()})();